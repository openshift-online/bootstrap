apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: bootstrap-global
  namespace: bootstrap
  annotations:
    description: "Bootstrap pipeline run for global cluster configuration"
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
spec:
  pipelineRef:
    name: bootstrap-pipeline
  params:
    - name: cluster-name
      value: "global"
    - name: cluster-type
      value: "ocp"
    - name: region
      value: "us-west-2"
    - name: domain
      value: "bootstrap.red-chesterfield.com"
    - name: instance-type
      value: "m5.2xlarge"
    - name: replicas
      value: "2"
    - name: target-namespace
      value: "openshift-gitops"
    - name: vault-enabled
      value: "true"
    - name: gitops-enabled
      value: "true"
    - name: dry-run
      value: "false"
  workspaces:
    - name: shared-workspace
      persistentVolumeClaim:
        claimName: bootstrap-workspace
  taskRunTemplate:
    serviceAccountName: pipeline
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: bootstrap-workspace
  annotations:
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi